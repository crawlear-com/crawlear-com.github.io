(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2571],{68925:function(t,e,i){Promise.resolve().then(i.bind(i,20662)),Promise.resolve().then(i.bind(i,22788)),Promise.resolve().then(i.bind(i,88780))},76968:function(t,e,i){"use strict";var a=i(59494);function r(){return document.location.href.indexOf("localhost")>=0}class s{static init(t){r()||a.ZP.initialize(t)}static pageview(t){r()||a.ZP.send({hitType:"pageview",page:t})}static event(t,e,i){r()||a.ZP.event({category:t,action:e,label:i})}}e.Z=s},76142:function(t,e){"use strict";class i{static #t=this.PLAYER_STATE_STOP="stop";static #e=this.PLAYER_STATE_START="start";static #i=this.PLAYER_STATE_PAUSE="pause";static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static isIphone(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}static isFirefox(){return/Firefox/i.test(navigator.userAgent)}static sanitizeUrl(t){let e=t.indexOf("?");return e>=0&&(t=t.slice(0,e)),"/"!==t[t.length-1]&&(t+="/"),t}static isYoutubeUrl(t){var e=t.match(/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return e&&11===e[2].length}static isInstagramUrl(t){var e=this.sanitizeUrl(t).match(/(?:(?:http|https):\/\/)?(?:www.)?(?:instagram.com|instagr.am|instagr.com)(?:\/(?:.?)*)*\/(?:reel|p|tv)\/(.*)*(?:\/)*/);return e&&e[1]}static getTiktokVideoId(t){var e=this.sanitizeUrl(t).match(/(?:(?:http|https):\/\/)?(?:www.)?tiktok.com\/@(.*)\/video\/(.*)*/);return e&&e[1]&&e[2]?e[2]:null}static isTiktokUrl(t){var e=this.sanitizeUrl(t).match(/(?:(?:http|https):\/\/)?(?:www.)?tiktok.com\/@(.*)\/video\/(.*)*/);return e&&e[1]&&e[2]}static isFacebookUrl(t){var e=this.sanitizeUrl(t).match(/(?:https?:\/\/)?(?:www\.)?(mbasic.facebook|m\.facebook|facebook|fb)\.(com|me)\/(?:(?:\w\.)*#!\/)?(?:pages\/)?(?:[\w\-.]*\/)*([\w\-.]*)/);return e&&e[1]&&e[2]}static tokenToTexts(t,e){return e.map(e=>t(e))}static getUidsFromUsers(t){let e=[];return t.forEach(t=>{t.uid&&e.push(t.uid)}),e}static millisToTime(t){let e=Math.floor(t/1e3),i=Math.floor(e/60),a=Math.floor(i/60);return{h:a%=24,m:i%=60,s:e%=60,mm:t%1e3}}static timeToMillis(t,e,i){let a=new Date,r=new Date;return r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),a.setMinutes(t),a.setSeconds(e),a.setMilliseconds(i),a.getTime()-r.getTime()}static printTime(t){return`${String(t.m).padStart(2,"0")}:${String(t.s).padStart(2,"0")}:${String(t.mm).padStart(3,"0")}`}static randomizeArray(t){let e=t.length,i;for(;0!==e;)i=Math.floor(Math.random()*e),e--,[t[e],t[i]]=[t[i],t[e]];return t}static getWinnerByPoints(t){let e=[...t];return e.sort(function(t,e){let i=t.points-e.points;return 0===i?t.id-e.id:i}),e}static getWinnerByPointsAndTime(t){let e=[...t];return e.sort(function(t,e){let i=t.points-e.points;return 0===i?t.time-e.time:i}),e}static getOrderedGameResult(t){return(t=this.calulateFinalGameResult(t)).players=t.players.sort((t,e)=>{let i=t.totalPoints-e.totalPoints;if(0===i){let i=t.totalTime-e.totalTime;return 0===i?e.totalGateProgression-t.totalGateProgression:i}return i}),t}static calulateFinalGameResult(t){let e={...t};return e.players.forEach(t=>{let e=0,i=0,a=0;t.zones.forEach(t=>{e+=t.totalPoints,i+=t.time,a+=t.gateProgression}),t.totalPoints=e,t.totalTime=i,t.totalGateProgression=a}),e}static getMapsURL(t,e){return`https://www.google.com/maps/search/?api=1&query=${t}%2C${e}`}}e.Z=i},20662:function(t,e,i){"use strict";i.d(e,{o:function(){return d},default:function(){return w}});var a=i(57437),r=i(2265),s=i(76968),n=i(16463);i(74590);var o=i(58064),c=(0,o.$)("d2f620e3631f52cef7b42ad173226d12d541cf60"),l=(0,o.$)("860c31201d181792f7c79c3169cb861ee2cfc0f2");async function u(){await c()}function d(t,e,i){(window.crawlear?.fbBase).getFullFirebase(async()=>{await l(window.crawlear.user.uid),i(h),e&&e.length>0?t.push(e):void 0===e&&t.push("/game")})}let h=1;var w=function(t){let{onLoginDestiny:e}=t,i=r.useRef(0),o=(0,n.useRouter)();return r.useEffect(()=>{if((!window.crawlear||!window.crawlear.user)&&0===i.current){var t;i.current=2,t=t=>{i.current=t},(window.crawlear?.fbBase).checkIfLogged(()=>{d(o,e,t)},()=>{u(),t(0)}),s.Z.init("G-J1NH6FT6E3"),s.Z.event("App","init",`${navigator.userAgent}`)}},[]),(0,a.jsx)(a.Fragment,{})}},22788:function(t,e,i){"use strict";i.d(e,{default:function(){return f}});var a=i(57437),r=i(2265),s=i(76968);let n=()=>document.location.href.indexOf("localhost")>=0;var o=function(){if("serviceWorker"in navigator){let t=(n(),"/sw.js");navigator.serviceWorker.register(t).then(function(t){s.Z.event("App","pwa","registered")},function(t){s.Z.event("App","pwa","registration error"),console.log("ServiceWorker registration failed: ",t)}).catch(function(t){console.log(t)})}else s.Z.event("App","pwa","service worker not supported"),console.log("service worker is not supported")},c=i(24495);i(76735),i(67059);var l=i(76142),u=i(15236),d=i(60516),h=i(69842),w=i(5186);let g={apiKey:"AIzaSyATlKKGw99gurKNwHL7BU1-_Llj0hwJy60",authDomain:"crawlear-com.firebaseapp.com",databaseURL:"https://crawlear-com-default-rtdb.europe-west1.firebasedatabase.app",projectId:"crawlear-com",storageBucket:"crawlear-com.appspot.com",messagingSenderId:"879856500816",appId:"1:879856500816:web:4287599cc229d5f4c3d155",measurementId:"G-YD7VLXPTM2"};class p{constructor(){this.app=(0,u.ZF)(g),this.provider=new w.hJ,this.auth=(0,w.v0)(),this.db=(0,h.ad)(),this.rdb=(0,d.N8)(),this.initAppCheck()}getFullFirebase(t){Promise.all([i.e(1118),i.e(5274),i.e(2759),i.e(2797)]).then(i.bind(i,17518)).then(e=>{let i=new e.default(this);window.crawlear=window.crawlear||{},window.crawlear.fb=i,t&&t()})}initAppCheck(){(0,c.yu)(this.app,{provider:new c.z9("6LfMPSIiAAAAABUfGLi_j7mnUr1snw9RriT8eBqP"),isTokenAutoRefreshEnabled:!0})}checkIfLogged(t,e){this.checkIfRedirect(t),this.auth.onAuthStateChanged(i=>{i?this.getUser(i.uid,e=>{this.setUserInContext(e,i.uid),t()},()=>{this.setUser(i,e=>{this.setUserInContext(e,i.uid),t()},()=>{})}):e&&e()})}checkIfRedirect(t){(0,w.cx)(this.auth).then(e=>{this.getUser(e.user.uid,i=>{this.setUserInContext(i,e.user.uid),t&&t(i)},()=>{this.setUser(e.user,t,t=>{this.setUserInContext(t,e.user.uid)})})}).catch(t=>{})}signOutWithGoogle(t){(0,w.w7)(this.auth).then(()=>{t&&t()})}signInWithGoogle(t){(0,w.Fb)(this.auth,w.a$).then(()=>{!l.Z.isMobile()||l.Z.isIphone()||l.Z.isFirefox()?(0,w.rh)(this.auth,this.provider).then(e=>{this.getUser(e.user.uid,i=>{this.setUserInContext(i,e.user.uid),t&&t(i)},()=>{this.setUser(e.user,t,t=>{this.setUserInContext(t,e.user.uid)})})}).catch(t=>{}):(0,w.F6)(this.auth,this.provider)}).catch(t=>{})}async getUser(t,e,i){let a=(0,h.JU)(this.db,"users",t),r=await (0,h.QT)(a);if(r.exists()){let t=r.data();t.uid=a.id,e&&e(t)}else i&&i()}async getUserExtraData(t,e,i){try{let i={},a=(0,h.IO)((0,h.hJ)(this.db,"games"),(0,h.ar)("uids","array-contains",t)),r=await (0,h.PL)(a);i.pilotGames=r.docs.length,a=(0,h.IO)((0,h.hJ)(this.db,"games"),(0,h.ar)("jids","array-contains",t)),r=await (0,h.PL)(a),i.judgeGames=r.docs.length,a=(0,h.IO)((0,h.hJ)(this.db,"routes"),(0,h.ar)("uids","array-contains",t)),r=await (0,h.PL)(a),i.routes=r.docs.length,e&&e(i)}catch(t){i&&i()}}async getFidFromFollow(t,e,i,a){try{let a=(0,h.IO)((0,h.hJ)(this.db,"follows"),(0,h.ar)("fromUid","==",t),(0,h.ar)("toUid","==",e),(0,h.b9)(1)),r=await (0,h.PL)(a),s=1===r.docs.length?r.docs[0].id:-1;i&&i(s)}catch(t){a&&a()}}isUserLogged(){return null!=this.auth.currentUser}async setUser(t,e,i){let{uid:a,displayName:r,photoURL:s,description:n,instagram:o}=t,c={displayName:r,photoURL:s,registrationDate:new Date().toString(),description:n||"",instagram:o||""};try{await (0,h.pl)((0,h.JU)(this.db,"users",a),c),e&&e(c)}catch(t){i&&i()}}setUserInContext(t,e){t.instagram=t.instagram||"",window.crawlear={...window.crawlear,user:t},window.crawlear.user.uid=e}async routeSearchByLatLon(t,e,i,a){try{let a=(0,h.hJ)(this.db,"routes"),r=(0,h.IO)(a,(0,h.ar)("point.lat",">",t.lat-e.lat),(0,h.ar)("point.lat","<",t.lat+e.lat)),s=await (0,h.PL)(r),n=[];s.forEach(i=>{let a=i.data();a.point.lon>t.lng-e.lon&&a.point.lon<t.lng+e.lon&&(a.rid=i.id,n.push(a))}),i&&i(n)}catch(t){a&&a(t)}}async getGpx(t,e,i){let a=(0,h.JU)(this.db,"gpx",t),r=await (0,h.QT)(a);if(r.exists()){let t=r.data();t.gid=a.id,e(t)}else i()}async getRoute(t,e,i,a){let r=(0,h.JU)(this.db,"routes",t),s=await (0,h.QT)(r);if(s.exists()){let t=s.data();t.rid=r.id,e&&t.gpx?this.getGpx(t.gpx,e=>{t.gpx=e,t.gpx.gid=e.gid,i(t)},a):i(t)}else a()}async getGame(t,e,i){let a=(0,h.JU)(this.db,"games",t),r=await (0,h.QT)(a);if(r.exists()){let t=r.data();t.gid=a.id,e&&e(t)}else i&&i()}}var f=function(){return r.useEffect(()=>{if(!window.crawlear||!window.crawlear.fbBase){let t=window.crawlear&&window.crawlear.fbBase||new p;window.crawlear=window.crawlear||{},window.crawlear.fbBase=window.crawlear.fbBase||t}o()},[]),(0,a.jsx)(a.Fragment,{})}}},function(t){t.O(0,[1118,1543,8250,935,3561,5315,4358,7481,9494,362,9144,5615,6027,9599,2759,4842,2971,7023,1744],function(){return t(t.s=68925)}),_N_E=t.O()}]);