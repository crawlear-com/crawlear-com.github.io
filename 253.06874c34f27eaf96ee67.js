"use strict";(self.webpackChunkcrawlear_com=self.webpackChunkcrawlear_com||[]).push([[253],{4448:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var n=a(96540),r=a(47767),o=a(788),i=a(18492);const l=function(e){let{onGameTypeChange:t,selectedGameType:a=0,selectedPointsType:r=0}=e;const{t:o}=(0,i.B)(["main"]),l=[o("gametype.aecar"),o("gametype.rey"),o("gametype.isrcc"),o("gametype.levante124"),o("gametype.copaespana"),o("gametype.minicrawlerpassion"),o("gametype.generic")],c=[n.createElement("div",null,o("gametype.modojuegoarcar")),n.createElement("div",null,o("gametype.modojuegorey")),n.createElement("div",null,o("gametype.modojuegoisrcc")),n.createElement("div",null,o("gametype.modojuegolevante124")),n.createElement("div",null,o("gametype.modojuegocopaespana")),n.createElement("div",null,o("gametype.modojuegominicrawlerpassion")),n.createElement("div",null,o("gametype.modojuegogeneric"))],[s,u]=n.useState({gameType:a}),m=[];return l.forEach(((e,t)=>{m.push(n.createElement("option",{key:t,value:t},l[t]))})),n.createElement(n.Fragment,null,n.createElement("div",{className:"gameType rounded1 rounded"},n.createElement("label",{htmlFor:"gameTypeSelect",className:"headerText bold"},o("gametype.modojuego"),n.createElement("select",{id:"gameTypeSelect",defaultValue:a,onChange:function(e){const a=e.target.selectedIndex;t&&t(a),u({gameType:a})}},m)),n.createElement("div",{className:"gameSelectText smallText"},c[s.gameType])))},c=function(e){let{player:t,i:a,onRemovePlayer:r,onClickPlayer:o,onGroupChange:l,maxGroups:c,editMode:s,isForJudge:u,onGameDirectorChange:m}=e;const{t:d}=(0,i.B)(["main"]),p=[];if(s){const e=[];for(let t=0;t<c;t++)e.push(n.createElement("option",{value:t},d("description.grupo")," ",t+1));p.push(n.createElement("button",{className:"buttonControlTextMinus",id:a,onClick:function(e){e.stopPropagation(),r&&r(e)}},"-")),p.push(n.createElement("div",null,n.createElement("select",{value:t.group,onChange:function(e){const a=e.target.selectedIndex;l&&l(t.id,a)}},e))),u&&p.push(n.createElement(n.Fragment,null,n.createElement("input",{type:"checkbox",onChange:function(e){m&&m(t.id,e.target.checked)}}),n.createElement("span",{className:"PlayerItemGameDirector"},d("description.directordepartida"))))}return n.createElement("li",{key:a,onClick:function(){o&&o(t.id)},className:"closed importantNote rounded playerListItem",value:t.name},n.createElement("div",{className:"playerBox"},n.createElement("img",{referrerPolicy:"no-referrer",src:t.avatar,alt:"avatar"}),n.createElement("div",{className:"textOverflow"},t.name),p))};var s=a(4948);const u=a.p+"78b7bb4a554381a9ba80.png",m=function(e){let{onUserSeachPlayerAdd:t,onUserClick:a,onPlusAddUserClick:r,mainText:o,secondaryText:l,iconSend:c,children:m}=e;const d=window.crawlear.fb,p=window.crawlear.fbBase,{t:g}=(0,i.B)(["main"]),[f,v]=n.useState(""),[E,h]=n.useState([]),y=n.useRef(),T=n.useRef();function w(e){const a=e.target,n=a.getAttribute("data-uid"),r=a.getAttribute("data-displayname"),o=a.getAttribute("data-photourl");h([]),v(""),t&&t({uid:n,displayName:r,photoURL:o})}function P(e){const t=e.target.nextElementSibling.getAttribute("data-uid");a&&a(t)}const G=[];let b,N=0;return E.length>0&&(G.push(n.createElement("div",{key:N,className:"userSearchResultsText smallText"},l)),N++),E.forEach((e=>{let a=c;t&&e.uid===window.crawlear.user.uid&&(a=u),G.push(n.createElement("div",{className:"bold userSearchItem",key:N},n.createElement("span",{onClick:P,className:"userSearchResult textOverflow"},e.displayName),n.createElement("img",{src:a,alt:"send icon","data-uid":e.uid,"data-displayname":e.displayName,"data-photourl":e.photoURL,onClick:w}))),N++})),r&&(b=n.createElement("button",{className:"buttonControlTextPlus",onClick:()=>{const e=T.current.value;h([]),v(""),r({uid:"",displayName:e})}},"+")),n.createElement("div",{className:"userSearchContainer rounded rounded3"},!s.isOffline||r?n.createElement(n.Fragment,null,n.createElement("div",{className:"userSearchText smallText"},o),n.createElement("input",{id:Date.now(),ref:T,className:"userSearchName",onChange:function(e){const t=e.target.value;v(t),!s.isOffline&&p.isUserLogged()&&(t.length>0?d.userSearch(t,(e=>{h(e)}),(()=>{})):h([]))},value:f})):n.createElement(n.Fragment,null),b,m,n.createElement("div",{ref:y,className:"resultsContainer"},G))},d=a.p+"9f5743cc8ab0daaa6f24.png",p=function(e){let{onUserSeachPlayerAdd:t,gameName:a,isForJudge:r}=e;const o=window.crawlear.fb,l=window.crawlear.fbBase,{t:c}=(0,i.B)(["main"]),s=n.useRef(0),[u,p]=n.useState(0),g=[];return s.current>0&&g.push(n.createElement("div",{key:0},s.current," ",c("description.peticionespendientes"))),n.createElement(m,{onUserSeachPlayerAdd:function(e){let{uid:n,displayName:r,photoURL:i}=e;if(n&&(n===window.crawlear.user.uid||window.confirm(c("content.peticionjuegoconfirmacion"))))if(n===window.crawlear.user.uid){const e=window.crawlear.user;t({uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,group:0})}else o.setUserGameRequest(window.crawlear.user.uid,window.crawlear.user.displayName,n,a,((e,a)=>{"pending"===a?(s.current+=1,p(u+1)):"accepted"===a?(t({uid:n,displayName:r,photoURL:i,group:0}),s.current-=1,p(u-1)):(s.current-=1,p(u-1))}))},onPlusAddUserClick:r?void 0:t,mainText:l.isUserLogged()?c("content.usuariodesistema"):c("content.usuarionosistema"),secondaryText:"".concat(c("content.enviorequest"),". ").concat(c("content.enviorequest2")),iconSend:d},g)};var g=a(99952);const f=function(e){let{inPlayers:t,onPlayerNumerChange:a,onGameDirectorChange:r,gameName:o,isForJudge:l,maxGroups:s}=e;const[u,m]=n.useState(t||[]),{t:d}=(0,i.B)(["main"]);function f(e){g.default.event("menu","removePlayer",u[e.target.id].name),delete u[e.target.id];const t=u.filter((e=>e));m(t),a&&a(t)}function v(e,t){const a=[...u];a[e].group=t,m(a)}function E(e,t){r&&r(e,t)}n.useEffect((()=>{a&&a(u)}),[u]);let h=u.length?d("description.jugadores"):d("description.nojugadores");return l&&(h=u.length?d("description.jueces"):d("description.nojueces")),n.createElement(n.Fragment,null,n.createElement("div",{className:"players rounded rounded1"},n.createElement("div",{className:"headerText bold"},d(l?"description.jueces":"description.jugadores")),n.createElement(p,{isForJudge:l,onUserSeachPlayerAdd:function(e){const t=e.displayName;!t||0===t.trim().length||u.find((t=>t.uid===e.uid&&e.uid.length>0))||l&&!e.uid||(u.push({id:u.length,uid:e.uid||"",name:t,avatar:e.photoURL||"".concat("https://eu.ui-avatars.com/api/?background=345B63&color=FFFFFF&name=").concat(t),group:0,time:0,points:0,battery:!1}),g.default.event("menu","addPlayer",t),a&&a(u))},gameName:o}),n.createElement("div",{className:"headerText"},d(l?"description.juecesenpartida":"description.usuariosenpartida")),n.createElement("ul",{className:"playersList"},0===u.length?h:u.map(((e,t)=>n.createElement(c,{key:t,player:e,i:t,onGameDirectorChange:E,maxGroups:s,onGroupChange:v,editMode:!0,isForJudge:l,onRemovePlayer:f}))))))};var v=a(45919);const E=function(e){let{onMaxTimeChange:t,minutes:a,seconds:r}=e;const o=[a,r];function i(e,a){const n=[...o];n[a]=e,e=function(e){const t=Number(e[0])||0;return 1e3*(Number(e[1])||0)+60*t*1e3}(n),t&&t(e)}return n.createElement("div",{className:"pickerContainer rounded rounded2"},n.createElement(v.A,{value:o[0],initialValue:0,minValue:0,maxValue:60,callback:e=>{i(e,0)}}),n.createElement("div",{className:"maxTimePickerContainer--separator"},"m"),n.createElement(v.A,{value:o[1],initialValue:0,minValue:0,maxValue:60,callback:e=>{i(e,1)}}),n.createElement("div",{className:"maxTimePickerContainer--separator"},"s"))};var h=a(8057);const y=function(e){let{onMaxTimeChange:t,onMaxPointsChange:a,showTimePicker:r,time:o,points:l}=e;const{t:c}=(0,i.B)(["main"]),s=h.default.millisToTime(o);let u=n.createElement(n.Fragment,null);return r&&(u=n.createElement(n.Fragment,null,n.createElement("p",null,c("content.maxTimeText1")),n.createElement(E,{onMaxTimeChange:t,onMaxPointsChange:a,minutes:s.m,seconds:s.s,millis:s.mm}))),n.createElement("div",null,u,n.createElement("p",null,c("content.maxTimeText2")),n.createElement("div",{className:"pickerContainer rounded rounded2"},n.createElement(v.A,{value:l,minValue:0,initialValue:0,callback:e=>{a(e)}})))},T=function(e){let{onZonesChange:t,value:a=1}=e;const{t:r}=(0,i.B)(["main"]);return n.createElement("div",null,n.createElement("p",null,r("content.seleccionZonas"),":"),n.createElement("div",{className:"pickerContainer rounded rounded2"},n.createElement(v.A,{value:a,minValue:1,maxValue:40,callback:e=>{t(e)},initialValue:1})))},w=function(e){let{onGroupsChange:t,value:a,minValue:r,maxValue:o}=e;const{t:l}=(0,i.B)(["main"]);return s.isOffline?n.createElement(n.Fragment,null):n.createElement("div",null,n.createElement("p",null,l("content.selecciongrupos"),":"),n.createElement("div",{className:"pickerContainer horizontalScrollContainer rounded rounded2"},n.createElement(v.A,{minValue:r||1,maxValue:o||10,value:a,callback:e=>{t(e)},initialValue:1})))},P=function(e){let{onGatesChange:t,zones:a,value:r,minValue:o,maxValue:l}=e;const{t:c}=(0,i.B)(["main"]),s=[];for(let e=0;e<a;e++)s.push(n.createElement("div",{key:"pickerContainer".concat(e)},n.createElement("div",{key:e,className:"zoneName"},c("description.zona")," ",e+1,":"),n.createElement("br",{key:"br".concat(e)}),n.createElement(v.A,{key:"picker".concat(e),minValue:o||1,maxValue:l||40,value:r,callback:a=>{t(a,e)},initialValue:1})));return n.createElement("div",null,n.createElement("p",null,c("content.seleccionPuertas"),":"),n.createElement("div",{className:"gatesPickerContainer pickerContainer horizontalScrollContainer rounded rounded2"},s))};var G=a(82894),b=a(78984),N=a(12996),x=a.n(N),C=a(93899),_=a.n(C);const k=function(e){let{preconfiguredGame:t,onGameCreated:a}=e;const{t:c}=(0,i.B)(["main"]),u=[],{isUserLoged:m}=n.useContext(b.F);if(n.useEffect((()=>{g.default.pageview("/gameconfigurator")}),[]),!m&&!s.isOffline)return n.createElement(r.C5,{state:{from:"/gameconfigurator"},to:{pathname:"/"}});const[d,p,v,E,h,N,C,k,S,A,M,j,O,R,F,U,V]=_()({preconfiguredGame:t,onGameCreated:a});return u.push(n.createElement(y,{key:0,mode:d.pointsType,onMaxPointsChange:k,onMaxTimeChange:S,time:d.maxTime,points:d.maxPoints,showTimePicker:!0})),d.gameType!==o.GAME_TYPE_KING&&(u.push(n.createElement(T,{key:1,game:d,value:d.zones,onZonesChange:A,onGatesChange:M,onMaxPointsChange:k,onMaxTimeChange:S})),u.push(n.createElement(P,{key:2,zones:d.zones,value:10,onGatesChange:M})),u.push(n.createElement(w,{key:3,onGroupsChange:O,value:1,minValue:1,maxValue:10})),s.isOffline||u.push(n.createElement(f,{key:4,isForJudge:!0,maxGroups:v,inPlayers:d.judges,gameName:d.name,onGameDirectorChange:F,onPlayerNumerChange:N}))),n.createElement(n.Fragment,null,n.createElement(G.default,{message:p}),n.createElement("div",{className:"newGameContainer rounded rounded1"},n.createElement("div",{className:"newGame"},n.createElement("div",{className:"headerText bold"},c("description.nuevaPartida")),n.createElement("div",{className:"newGameRow"},n.createElement("span",{className:""},c("description.nombre")),": ",n.createElement("input",{value:d.name,className:"newGameNameInput",type:"text",onChange:j})),n.createElement("div",{className:"newGameRow"},n.createElement("span",{className:""},c("description.fecha")),": ",d.date.toLocaleString()),n.createElement("div",{className:"newGameRow"},n.createElement("span",{className:""},c("description.esPublica")),": ",n.createElement("input",{type:"checkbox",checked:d.isPublic,onChange:R})),n.createElement("div",{className:"newGameRow"},n.createElement("span",{className:""},c("description.localizacion")),":",n.createElement(x(),{onLocationResolved:h})))),n.createElement(l,{selectedGameType:d.gameType,selectedPointsType:d.pointsType,onGameTypeChange:e=>{E(e)}}),u,n.createElement(f,{gameName:d.name,isForJudge:!1,inPlayers:d.players,maxGroups:v,onPlayerNumerChange:e=>{C&&C(e)}}),n.createElement("input",{type:"checkbox",onChange:U}),c("description.ordenRamdomJugadores"),n.createElement("p",null,n.createElement("button",{className:"importantNote",onClick:()=>{V(v,d)}},c("description.crearjuego")),n.createElement("button",{onClick:()=>{window.location.reload()}},c("description.atras"))))}},36236:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=a(63549),r=a(4736),o=a(35459),i=a(57311),l=a(55448),c=a(46101),s=a(96688),u=a(788),m={getMaxTimeAndPointsFromGameType:function(e){var t=0,a=0;switch(e){case u.GAME_TYPE_AECAR:t=n.AecarGameScores.maxPoints,a=n.AecarGameScores.maxTime;break;case u.GAME_TYPE_KING:t=l.KingGameScores.maxPoints,a=l.KingGameScores.maxTime;break;case u.GAME_TYPE_ISRCC:t=r.IsrccGameScores.maxPoints,a=r.IsrccGameScores.maxTime;break;case u.GAME_TYPE_LEVANTE:t=o.Levante124GameScores.maxPoints,a=o.Levante124GameScores.maxTime;break;case u.GAME_TYPE_COPAESPANA:t=i.RegionalZonaRcGameScores.maxPoints,a=i.RegionalZonaRcGameScores.maxTime;break;case u.GAME_TYPE_MINICRAWLERPASSION:t=c.MiniCrawlerPassionGameScores.maxPoints,a=c.MiniCrawlerPassionGameScores.maxTime;break;case u.GAME_TYPE_GENERIC:t=s.GenericGameScores.maxPoints,a=s.GenericGameScores.maxTime;break;default:t=0,a=0}return[a,t]}};t.default=m},12996:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return r(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(a(96540)),c=i(a(25448)),s=i(a(8057)),u=a(32418);t.default=function(e){var t,a=e.onLocationResolved,n=l.useState(0),r=n[0],o=n[1],i=l.useState({latitude:0,longitude:0}),m=i[0],d=i[1],p=(0,u.useTranslation)(["main"]).t;return navigator.geolocation?0===r?t=l.createElement("a",{className:"bold",href:"https://crawlear.com",onClick:function(e){e.preventDefault(),navigator.geolocation?(o(2),navigator.geolocation.getCurrentPosition((function(e){var t={latitude:e.coords.latitude,longitude:e.coords.longitude};a(t),o(1),d(t)}),(function(){a({}),o(0)}))):o(0)}},p("description.obtener")):2===r?t=l.createElement(c.default,null):1===r&&(t=l.createElement(l.Fragment,null,l.createElement("span",null,"(","".concat(m.latitude,",").concat(m.longitude),")"),l.createElement("a",{href:s.default.getMapsURL(m.latitude,m.longitude),rel:"noreferrer",target:"_blank"},p("description.vergooglemaps")))):t=l.createElement("div",{className:""},p("content.nogeolocation")),t}},93899:function(e,t,a){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&r(t,e,a);return o(t,e),t},l=this&&this.__spreadArray||function(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(a(96540)),u=a(788),m=a(788),d=c(a(36236)),p=a(4948),g=a(84976),f=a(32418),v=c(a(99952)),E=c(a(8057));t.default=function(e){var t=e.preconfiguredGame,a=e.onGameCreated,r=s.useState((function(){var e=t||new u.Game("",(new Date).toLocaleDateString(),{latitude:0,longitude:0},!0,m.GAME_TYPE_LEVANTE,[],[],6e5,40,new Array(1).fill(10),1,0,[],[],[]);return e.date=(new Date).toLocaleDateString(),e})),o=r[0],i=r[1],c=(0,g.useNavigate)(),h=s.useState(""),y=h[0],T=h[1],w=s.useState(!1),P=w[0],G=w[1],b=s.useState(1),N=b[0],x=b[1],C=(0,f.useTranslation)(["main"]).t,_=window.crawlear.fb;function k(e){var t=n({},o),a="addJudge";o.judges.length>e.length&&(a="removeJudge"),v.default.event("menu",a,e.length),t.judges=l([],e,!0),p.isOffline&&!t.owner.length&&t.owner.push(m.OFFLINE_USER_UID),i(t),T("")}return s.useEffect((function(){window.scrollTo(0,0),p.isOffline&&k([u.OfflinePlayer])}),[]),[o,y,N,function(e){var t,a=n({},o);v.default.event("menu","playModeChange",e),a.gameType=e,t=d.default.getMaxTimeAndPointsFromGameType(a.gameType),a.maxTime=t[0],a.maxPoints=t[1],i(a)},function(e){if(e.latitude&&e.longitude){var t=n({},o);t.location=e,i(t)}else T(C("error.nogeolocation"))},k,function(e){var t=n({},o),a="addPlayer";o.players.length>e.length&&(a="removePlayer"),v.default.event("menu",a,e.length),t.players=l([],e,!0),i(t),T("")},function(e){var t=n({},o);v.default.event("menu","maxPointsSet",e),t.maxPoints=e,i(t)},function(e){var t=n({},o);t.maxTime=e,v.default.event("menu","maxTimeSet",e),i(t)},function(e){var t=n({},o);o.zones<e?t.gates.push(10):t.gates.pop(),t.zones=e,v.default.event("menu","zonesSet",e),i(t)},function(e,t){var a=n({},o);a.gates[t]=e,v.default.event("menu","gateSet",e),i(a)},function(e){var t=n({},o),a=e.target.value;a&&(t.name=a,i(t),T(""))},function(e){x(e)},function(e){var t=n({},o);t.isPublic=e.target.value,i(t)},function(e,t){var a=o.judges[e].uid,r=n({},o);if(t&&!r.owner.find((function(e){return e===a})))r.owner.push(a),i(r);else if(!t&&r.owner.find((function(e){return e===a}))){var l=r.owner.indexOf(a);r.owner.splice(l,1),i(r)}},function(e){var t=e.target.checked;G(t)},function(e,t){var r=function(e,t){for(var a=new Array(e).fill(0),n=0;n<t.players.length;n++)a[t.players[n].group]++;return void 0===a.find((function(e){return 0===e}))}(e,t);if(window.scrollTo(0,0),t.name&&t.name.length)if(r)if(t.judges.length||t.gameType===m.GAME_TYPE_KING)if(t.players.length)if(t.gameType===m.GAME_TYPE_KING||t.owner.length){if(t.gameType!==m.GAME_TYPE_KING&&r||t.gameType===m.GAME_TYPE_KING){var o=n({},t);t.gameType===m.GAME_TYPE_KING&&(o.judges.push(n({},window.crawlear.user)),o.zones=1,o.gates=new Array(1).fill(1)),o.uids=E.default.getUidsFromUsers(o.players),o.jids=E.default.getUidsFromUsers(o.judges),P&&function(e){if(e.players.length){var t=l([],e.players,!0);t=t.sort((function(e,t){return Math.random()-.5})),e.players=t,u.GameUtils.redoPlayersIds(e)}}(o),u.GameUtils.init(o,u.GameUtils.getGameTypeControlTextValuesInit(o.gameType),u.GameUtils.getGameTypeFiascoControlTextValuesInit(o.gameType),!0),p.isOffline&&a?a(o):_.setGame(o,(function(e){o.gid=e.gid,_.createGameProgression(o),i(o),c("/game")}),(function(){}))}}else T(C("error.nodirectordepartida"));else T(C("error.nojugadores"));else T(C("error.nojueces"));else T(C("error.rellenargrupos"));else T(C("error.nonombre"))}]}}}]);